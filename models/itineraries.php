<?phpdefined('_JEXEC') or die;class ItineraryModelItineraries extends JModelList{	public function __construct($config = array())	{		if(empty($config['filter_fields']))		{			$config['filter_fields'] = array(				'clef', 'a.clef',				'date_creation','a.date_creation',				'date_modification', 'a.date_modification',				'titre', 'a.titre',				'description', 'a.description',				'illustrations','a.illustrations',				'titre_illustrations','a.titre_illustrations',				'langue', 'a.langue',				'clef_planificateur', 'a.clef_planificateur',				'duree', 'a.duree',				'payant', 'a.payant',				'tarif', 'a.tarif',				'nombre_messages','a.nombre_messages',				'note', 'a.note',				'nombre_commentaires','a.nombre_commentaires',				'latitude', 'a.latitude',				'longitude', 'a.longitude',				'activation_planificateur', 'a.activation_planificateur',				'l.titre','l.image',				'l.title AS titre_langue',				'l.image AS image_langue'			);		}		//'nombre_commentaires',		parent::__construct($config);	}		protected function populateState($ordering = null, $direction = null)	{				parent::populateState('a.titre','asc');	}		protected function getListQuery()	{		$user =(int) JFactory::getUser()->id;				if (!empty($user))		{				$db = $this->getDbo();			$query = $db->getQuery(true);						$query->select('a.clef, a.titre, a.description, a.titre_illustrations, a.illustrations, a.nombre_messages, a.note, a.nombre_commentaires,a.langue, a.duree, a.payant, a.tarif, a.activation_planificateur');			$query->from($db->quoteName('#__itinerary_parcours').' AS a');						$query->select('l.title AS titre_langue, l.image AS image_langue')				->join('LEFT', $db->quoteName('#__languages') . ' AS l ON l.lang_code = a.langue');			$query->where('clef_planificateur = '.(int) $user);						$orderCol = $this->state->get('list.ordering');			$orderDirn = $this->state->get('list.direction');						$query->order($db->escape($orderCol.' '.$orderDirn));						return $query;		}		else		{			return false;		}	}		public function getItineraryMsgList($idParcours=null)	{		if(!empty($idParcours))		{			$user = JFactory::getUser()->id;						$db = $this->getDbo();			$query = $db->getQuery(true);			$query->select('m.clef');			$query->from($db->quoteName('#__itinerary_messages').' AS m');			$query->where('m.clef_planificateur = '.(int) $user, 'AND');			$query->where('m.clef_parcours = '.(int) $idParcours);			$query->order('m.clef ASC');						$db->setQuery($query);						$result=$db->loadColumn();						if($result!=null)			{				return $result;			}			else			{				return false;			}		}		else		{			return false;		}	}}